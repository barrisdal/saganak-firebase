<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Grup Saƒüanak Setlist ‚ö°</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      background-color: #f4f4f4;
    }
    h1 {
      color: #333;
    }
    select, input[type="text"], textarea, button {
      font-size: 16px;
    }
    select, input[type="text"], textarea {
      width: 100%;
      padding: 8px;
      margin: 6px 0 12px;
      border-radius: 4px;
      border: 1px solid #ddd;
      box-sizing: border-box;
    }
    button {
      padding: 10px 16px;
      margin: 6px 6px 12px 0;
      background-color: #28a745;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    button:hover {
      background-color: #218838;
    }
    #songHtmlContainer {
      margin-top: 20px;
      padding: 10px;
      border: 1px solid #ccc;
      background-color: #fff;
      min-height: 150px;
      white-space: pre-wrap;
      overflow-wrap: break-word;
      outline: none;
      font-size: 16px;
    }
    #zoomControls {
      margin-bottom: 10px;
    }
    #zoomControls button {
      background-color: #6c757d;
      color: white;
      font-size: 16px;
      padding: 4px 10px;
      margin-right: 5px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    #zoomControls button:hover {
      background-color: #5a6268;
    }
    h2.song-title {
      font-weight: bold;
      margin-bottom: 10px;
    }
    .section {
      background: white;
      padding: 15px;
      margin-bottom: 25px;
      border-radius: 6px;
      box-shadow: 0 0 8px rgba(0,0,0,0.1);
    }
    label {
      font-weight: bold;
    }
    #rootButtons button {
      background-color: #007bff;
      margin: 2px;
    }
    #rootButtons button.selected {
      background-color: #0056b3;
    }
    #deleteSongLink {
      color: red;
      display: inline-block;
      margin-top: 10px;
      text-decoration: none;
      font-weight: bold;
    }
    #deleteSongLink:hover {
      text-decoration: underline;
    }
  </style>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
</head>
<body>
  <h1>Grup Saƒüanak Setlist ‚ö°</h1>

  <div class="section">
    <label for="categoryFilter">Kategori Filtrele:</label>
    <select id="categoryFilter">
      <option value="">T√ºm Kategoriler</option>
    </select>

    <label for="songsDropdown">≈ûarkƒ± Se√ß:</label>
    <select id="songsDropdown">
      <option value="" disabled selected>Bir ≈üarkƒ± se√ßin</option>
    </select>

    <div style="margin-top: 10px;">
      <strong>Ton Se√ß (Root):</strong>
      <div id="rootButtons" style="margin-top:5px;"></div>
    </div>

    <button id="transposeUpButton">1 Ton Yukarƒ±</button>
    <button id="transposeDownButton">1 Ton A≈üaƒüƒ±</button>
    <button id="saveButton">≈ûarkƒ± D√ºzenlemeyi Kaydet</button>
    <a href="#" id="deleteSongLink">üóëÔ∏è Bu ≈ûarkƒ±yƒ± Sil</a>

    <label style="margin-top: 12px; font-weight: bold;" for="editSongCategory">Se√ßili ≈ûarkƒ± Kategorisi:</label>
    <select id="editSongCategory">
      <option value="" disabled selected>Kategori se√ßin</option>
    </select>

    <div id="zoomControls">
      <button id="zoomInButton">+</button>
      <button id="zoomOutButton">-</button>
    </div>
    <div id="songHtmlContainer" contenteditable="true"></div>
  </div>

  <div class="section">
    <h3>Yeni ≈ûarkƒ± Ekle</h3>
    <label for="newSongName">≈ûarkƒ± Adƒ±:</label>
    <input type="text" id="newSongName" placeholder="≈ûarkƒ± adƒ± girin" />

    <label for="newSongCategory">Kategori Se√ß:</label>
    <select id="newSongCategory">
      <option value="" disabled selected>Kategori se√ßin</option>
    </select>

    <label for="newSongHtml">Akorlar ve ≈ûarkƒ± S√∂zleri (HTML formatƒ±nda):</label>
    <textarea id="newSongHtml" rows="8" placeholder="≈ûarkƒ± akorlarƒ± ve s√∂zleri HTML olarak"></textarea>

    <button id="addSongButton">Yeni ≈ûarkƒ±yƒ± Ekle</button>
  </div>

  <div class="section">
    <h3>Yeni Kategori Ekle</h3>
    <input type="text" id="newCategoryInput" placeholder="Kategori adƒ± girin" />
    <button id="addCategoryButton">Kategori Ekle</button>
  </div>

<script>
  const firebaseConfig = {
    apiKey: "AIzaSyDAhFPe_j750iRzfv96xHAMX488sj6xBTs",
    authDomain: "saganak-24ec8.firebaseapp.com",
    databaseURL: "https://saganak-24ec8-default-rtdb.europe-west1.firebasedatabase.app",
    projectId: "saganak-24ec8",
    storageBucket: "saganak-24ec8.appspot.com",
    messagingSenderId: "394236997954",
    appId: "1:394236997954:web:c49ebc99d98722e31b98db",
    measurementId: "G-S1C78RYR9Z"
  };

  const app = firebase.initializeApp(firebaseConfig);
  const database = firebase.database();

  const categoriesRef = database.ref('Categories');
  const songsRef = database.ref('Songs');
  const currentSelectedSongRef = database.ref('CurrentSelectedSong');

  const categoryFilter = document.getElementById('categoryFilter');
  const newSongCategory = document.getElementById('newSongCategory');
  const songsDropdown = document.getElementById('songsDropdown');
  const songHtmlContainer = document.getElementById('songHtmlContainer');
  const saveButton = document.getElementById('saveButton');
  const transposeUpButton = document.getElementById('transposeUpButton');
  const transposeDownButton = document.getElementById('transposeDownButton');
  const newSongName = document.getElementById('newSongName');
  const newSongHtml = document.getElementById('newSongHtml');
  const addSongButton = document.getElementById('addSongButton');
  const newCategoryInput = document.getElementById('newCategoryInput');
  const addCategoryButton = document.getElementById('addCategoryButton');
  const editSongCategory = document.getElementById('editSongCategory');
  const rootButtonsDiv = document.getElementById('rootButtons');
  const deleteSongLink = document.getElementById('deleteSongLink');

  const zoomInButton = document.getElementById('zoomInButton');
  const zoomOutButton = document.getElementById('zoomOutButton');

  let currentSongId = null;
  let currentSongData = null;
  let allSongs = {};
  let allCategories = {};
  let currentFontSize = 16;

  const rootNotes = ['C', 'C#', 'Db', 'D', 'D#', 'Eb', 'E', 'F', 'F#', 'Gb', 'G', 'G#', 'Ab', 'A', 'A#', 'Bb', 'B'];

  const noteMap = {
    'C': 0, 'B#': 0, 'C#': 1, 'Db': 1, 'D': 2, 'D#': 3, 'Eb': 3, 'E': 4, 'Fb': 4,
    'F': 5, 'E#': 5, 'F#': 6, 'Gb': 6, 'G': 7, 'G#': 8, 'Ab': 8, 'A': 9, 'A#': 10, 'Bb': 10, 'B': 11, 'Cb': 11
  };

  const indexToNoteSharp = ['C','C#','D','D#','E','F','F#','G','G#','A','A#','B'];

  function transposeChordFull(chord, steps) {
    const regex = /^([A-G](#|b)?)(.*)$/;
    const match = chord.match(regex);
    if (!match) return chord;
    const root = match[1];
    const suffix = match[3] || '';
    let noteIndex = noteMap[root];
    if (noteIndex === undefined) return chord;
    let newIndex = (noteIndex + steps) % 12;
    if (newIndex < 0) newIndex += 12;
    let newRoot = indexToNoteSharp[newIndex];
    return newRoot + suffix;
  }

  function transposeSongHtml(html, steps) {
    return html.replace(/(<span[^>]*id=['"]?nota['"]?[^>]*>)([^<]+)(<\/span>)/gi, (match, startTag, chordText, endTag) => {
      const transposedChord = transposeChordFull(chordText.trim(), steps);
      return startTag + transposedChord + endTag;
    });
  }

  // ... kalan kod aynƒ± ...

  zoomInButton.addEventListener('click', () => {
    currentFontSize += 2;
    songHtmlContainer.style.fontSize = `${currentFontSize}px`;
  });

  zoomOutButton.addEventListener('click', () => {
    if (currentFontSize > 6) {
      currentFontSize -= 2;
      songHtmlContainer.style.fontSize = `${currentFontSize}px`;
    }
  });

  // ... t√ºm mevcut Firebase logic burada devam ediyor ...
</script>

</body>
</html>
